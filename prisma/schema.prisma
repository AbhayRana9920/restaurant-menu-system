// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id        String   @id @default(cuid())
    name      String
    email     String   @unique
    country   String
    otp       String?
    otpExpires DateTime?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    restaurants Restaurant[]
}

model Restaurant {
    id        String   @id @default(cuid())
    name      String
    location  String
    ownerId   String
    owner     User     @relation(fields: [ownerId], references: [id])
    categories Category[]
    dishes    Dish[]
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model Category {
    id           String   @id @default(cuid())
    name         String
    restaurantId String
    restaurant   Restaurant @relation(fields: [restaurantId], references: [id])
    dishes       DishCategory[]
    createdAt    DateTime @default(now())
    updatedAt    DateTime @updatedAt
}

model Dish {
    id           String   @id @default(cuid())
    name         String
    description  String
    price        Float
    image        String
    isVeg        Boolean  @default(true)
    spiceLevel   Int?     // 0-3 scale for example
    restaurantId String
    restaurant   Restaurant @relation(fields: [restaurantId], references: [id])
    categories   DishCategory[]
    createdAt    DateTime @default(now())
    updatedAt    DateTime @updatedAt
}

model DishCategory {
    dishId     String
    categoryId String
    dish       Dish     @relation(fields: [dishId], references: [id])
    category   Category @relation(fields: [categoryId], references: [id])

    @@id([dishId, categoryId])
}
